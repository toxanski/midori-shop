!function(){var t={85:function(){for(var t=document.querySelectorAll(".modal-open"),e=0;e<t.length;e++)t[e].addEventListener("click",(function(t){t.preventDefault(),r()}));document.querySelector(".modal-overlay").addEventListener("click",r);var n=document.querySelectorAll(".modal-close");for(e=0;e<n.length;e++)n[e].addEventListener("click",r);function r(){var t=document.querySelector("body"),e=document.querySelector(".modal");e.classList.toggle("opacity-0"),e.classList.toggle("pointer-events-none"),t.classList.toggle("modal-active")}document.onkeydown=function(t){("key"in(t=t||window.event)?"Escape"===t.key||"Esc"===t.key:27===t.keyCode)&&document.body.classList.contains("modal-active")&&r()}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var c=e[r]={exports:{}};return t[r](c,c.exports,n),c.exports}!function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.cart=document.querySelector(t)}var n,r;return n=e,(r=[{key:"cartNode",get:function(){return this.cart},set:function(t){console.log(t),this.cart=document.querySelector(t)}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.productContainer=document.querySelector(e),this.cart=n}var e,n;return e=t,(n=[{key:"addToCart",value:function(){var e=this;this.productContainer.querySelectorAll(".".concat(t.classes.button)).forEach((function(t){t.addEventListener("click",(function(t){var n=t.target;t.preventDefault();var r=n.dataset.name;fetch("/cart/add?name=".concat(r)).then((function(t){return t.text()})).then((function(t){e.cart.cartNode.innerHTML=t})).then((function(){var t=document.querySelector(".user-info__cart-quantity"),e=document.querySelector(".cart-total__count");t.innerHTML="(".concat(e.textContent,")")})).catch((function(t){console.error(t)}))}))}))}},{key:"openCartAction",value:function(){var e=this;document.querySelector(".".concat(t.classes.open)).addEventListener("click",(function(t){t.preventDefault(),fetch("/cart/open").then((function(t){return t.text()})).then((function(t){e.cart.cartNode.innerHTML=t})).catch((function(t){console.error(t)}))}))}},{key:"clearCartAction",value:function(){var e=this;document.querySelector(".".concat(t.classes.clear)).addEventListener("click",(function(t){confirm("Очистить корзину от товаров?")&&(t.preventDefault(),fetch("/cart/clear").then((function(t){return t.text()})).then((function(t){e.cart.cartNode.innerHTML=t})).catch((function(t){console.error(t)})))}))}},{key:"removeCartProduct",value:function(){var t=this;document.querySelector(".modal").addEventListener("click",(function(e){if(e.target&&e.target.classList.contains("remove-product")){var n=e.target.getAttribute("data-id");fetch("/cart/remove/?id=".concat(n)).then((function(t){return console.log(t),t.text()})).then((function(e){t.cart.cartNode.innerHTML=e})).then((function(){var t=document.querySelector(".user-info__cart-quantity"),e=document.querySelector(".cart-total__count");t.innerHTML=e?"(".concat(e.textContent,")"):"(0)"})).catch((function(t){console.error(t)}))}}))}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o.classes={button:"product__button",open:"modal-open",clear:"modal-clear",remove:"remove-product"};var c=new o(".product-list",new e(".cart"));c.addToCart(),c.openCartAction(),c.clearCartAction(),c.removeCartProduct(),n(85)}()}();