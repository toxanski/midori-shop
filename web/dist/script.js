!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.cart=document.querySelector(e)}var n,o;return n=t,(o=[{key:"cartNode",get:function(){return this.cart},set:function(e){console.log(e),this.cart=document.querySelector(e)}}])&&e(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.productContainer=document.querySelector(t),this.cart=n}var t,o;return t=e,(o=[{key:"addToCart",value:function(){var t=this;this.productContainer.querySelectorAll(".".concat(e.classes.button)).forEach((function(e){e.addEventListener("click",(function(e){var n=e.target;e.preventDefault();var o=n.dataset.name;fetch("/cart/add?name=".concat(o)).then((function(e){return e.text()})).then((function(e){t.cart.cartNode.innerHTML=e})).then((function(){var e=document.querySelector(".user-info__cart-quantity"),t=document.querySelector(".cart-total__count");e.innerHTML="(".concat(t.textContent,")")})).catch((function(e){console.error(e)}))}))}))}},{key:"openCartAction",value:function(){var t=this;document.querySelector(".".concat(e.classes.open)).addEventListener("click",(function(e){e.preventDefault(),fetch("/cart/open").then((function(e){return e.text()})).then((function(e){t.cart.cartNode.innerHTML=e})).catch((function(e){console.error(e)}))}))}},{key:"clearCartAction",value:function(){var t=this;document.querySelector(".".concat(e.classes.clear)).addEventListener("click",(function(e){confirm("Очистить корзину от товаров?")&&(e.preventDefault(),fetch("/cart/clear").then((function(e){return e.text()})).then((function(e){t.cart.cartNode.innerHTML=e})).catch((function(e){console.error(e)})))}))}},{key:"removeCartProduct",value:function(){var e=this;document.querySelector(".modal").addEventListener("click",(function(t){if(t.target&&t.target.classList.contains("remove-product")){var n=t.target.getAttribute("data-id");fetch("/cart/remove/?id=".concat(n)).then((function(e){return console.log(e),e.text()})).then((function(t){e.cart.cartNode.innerHTML=t})).then((function(){var e=document.querySelector(".user-info__cart-quantity"),t=document.querySelector(".cart-total__count");e.innerHTML=t?"(".concat(t.textContent,")"):"(0)"})).catch((function(e){console.error(e)}))}}))}}])&&n(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();o.classes={button:"product__button",open:"modal-open",clear:"modal-clear",remove:"remove-product"};var r=new o(".product-list",new t(".cart"));r.addToCart(),r.openCartAction(),r.clearCartAction(),r.removeCartProduct(),new t;for(var c=document.querySelectorAll(".modal-open"),a=0;a<c.length;a++)c[a].addEventListener("click",(function(e){e.preventDefault(),v()}));for(var i=document.querySelectorAll(".modal-open-order"),u=0;u<i.length;u++)i[u].addEventListener("click",(function(e){e.preventDefault(),y(),fetch("/cart/order").then((function(e){return e.text()})).then((function(e){document.querySelector(".order-container").innerHTML=e})).catch((function(e){console.error(e)}))}));document.querySelector(".modal-overlay").addEventListener("click",v),document.querySelector(".modal-overlay-order").addEventListener("click",y);for(var l=document.querySelectorAll(".modal-close"),d=0;d<l.length;d++)l[d].addEventListener("click",v);for(var s=document.querySelectorAll(".modal-close-order"),f=0;f<s.length;f++)s[f].addEventListener("click",y);function v(){var e=document.querySelector("body"),t=document.querySelector(".modal");t.classList.toggle("opacity-0"),t.classList.toggle("pointer-events-none"),e.classList.toggle("modal-active")}function y(){v();var e=document.querySelector(".modal-order");e.classList.toggle("opacity-0"),e.classList.toggle("pointer-events-none"),document.body.classList.toggle("modal-active-order")}document.onkeydown=function(e){var t;(t="key"in(e=e||window.event)?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&document.body.classList.contains("modal-active")&&v(),t&&document.body.classList.contains("modal-active-order")&&y()}}();